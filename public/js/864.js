"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[864],{864:(t,e,a)=>{a.r(e),a.d(e,{default:()=>i});const s={name:"AllUser",data:function(){return{name:"",phone:"",prefix:"",role:"",result:"",results:[],allresults:[],val:"",roles:["Администратор","Менеджер"],checkedTel:"",password:"",id:"",fields:{ID:"id",ФИО:"name",Телефон:"phone",Роль:"role",Префикс:"prefix"}}},methods:{getUsers:function(){var t=this;axios.get("/api/users").then((function(e){t.$data.results=e.data,t.$data.allresults=e.data}))},filter:function(t){var e,a=this;if(""===t)this.results=this.allresults;else{this.results=this.allresults;this.results=(e=t,a.$data.results.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1})))}},show:function(t){UIkit.modal("#modal-change").show(),this.name=t[0],this.phone=t[1],this.prefix=t[2],this.role=t[3],this.id=t[4]},checkPhone:function(){var t=this;axios.post("/api/check/phone",{Phone:this.phone}).then((function(e){0===e.data.length?t.$data.checkedTel="uk-form-success":(t.$data.checkedTel="uk-form-danger",UIkit.notification({message:"Пользователь с данным номером существует в системе"}))})).catch((function(t){UIkit.notification({message:t,status:"danger"})}))},updateUser:function(){var t=this;axios.post("/api/users/update",{id:this.id,name:this.name,password:this.password||"null",phone:this.phone,prefix:this.prefix,role:this.role}).then((function(t){UIkit.modal("#modal-change").hide(),UIkit.notification({message:"Пользователь обновлен"})})).catch((function(t){t.response.data;UIkit.notification({message:"Ошибка изменения. Обратитесь к администратору"})})).finally((function(){UIkit.modal("#modal-change").hide(),t.getUsers()}))},deleteUser:function(t){var e=this;axios.post("/api/users/delete",{id:t[0],name:"null",password:"null",phone:"null",prefix:"null",role:0}).then((function(a){UIkit.notification({message:"Пользователь удален"}),e.results.splice(t[1],1),e.allresults.splice(t[1],1)})).catch((function(t){t.response.data;UIkit.notification({message:"Ошибка удаления. Обратитесь к администратору"})})).finally((function(){UIkit.modal("#modal-change").hide(),e.getUsers()}))}},mounted:function(){axios.get("/sanctum/csrf-cookie"),this.getUsers()}};const i=(0,a(1900).Z)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-width-1-1 uk-padding uk-padding-remove-top"},[a("h1",{staticClass:"uk-text-center"},[t._v("Список всех пользователей")]),t._v(" "),a("div",{attrs:{id:"modal-change","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-modal-body uk-margin-auto-vertical"},[a("div",{staticClass:"uk-margin uk-modal-container-large"},[a("h3",{staticClass:"uk-card-title"},[t._v("Редактирование пользователя")]),t._v(" "),a("div",{staticClass:"uk-grid-small",attrs:{"uk-grid":""}},[a("form",{staticClass:"uk-width-1-1",on:{submit:function(e){return e.preventDefault(),t.updateUser()}}},[a("div",{staticClass:"uk-grid-match uk-child-width-1-1@s",attrs:{"uk-grid":""}},[a("div",[a("div",{staticClass:"uk-card-default uk-card-body"},[a("div",{staticClass:"uk-grid-small",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-width-1-3@s"},[a("label",{staticClass:"uk-form-label"},[t._v("ФИО")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[a("label",{staticClass:"uk-form-label"},[t._v("Телефон")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"uk-input",class:t.checkedTel,attrs:{type:"text",placeholder:"",required:"",pattern:"\\d+"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[a("label",{staticClass:"uk-form-label"},[t._v("Пароль")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"uk-input",attrs:{type:"text",required:"",placeholder:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[a("label",{staticClass:"uk-form-label"},[t._v("Префикс")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.prefix,expression:"prefix"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"",required:""},domProps:{value:t.prefix},on:{input:function(e){e.target.composing||(t.prefix=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[a("label",{staticClass:"uk-form-label"},[t._v("Роль")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.role,expression:"role"}],staticClass:"uk-select",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.role=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"1"}},[t._v("Админ")]),t._v(" "),a("option",{attrs:{value:"2"}},[t._v("Менеджер")])])])])]),t._v(" "),a("button",{staticClass:"uk-button uk-button-primary uk-width-1-3@m uk-width-1-1@s uk-align-center uk-margin-bottom"},[t._v(" Сохранить ")])])])])])])])]),t._v(" "),a("div",{staticClass:"uk-card-default uk-card-small uk-card-hover"},[a("div",{staticClass:"uk-card-header"},[a("div",{staticClass:"uk-grid uk-grid-small"},[a("div",{staticClass:"uk-width-expand"},[a("div",{staticClass:"uk-inline uk-width-1-1"},[a("span",{staticClass:"uk-form-icon uk-form-icon-flip",attrs:{"data-uk-icon":"icon: search"}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"uk-input uk-width-1-1 search-fld",attrs:{type:"text",placeholder:"Поиск по ФИО"},domProps:{value:t.val},on:{input:[function(e){e.target.composing||(t.val=e.target.value)},function(e){return t.filter(t.val)}]}})])])])]),t._v(" "),a("div",{staticClass:"uk-card-body uk-margin-medium-bottom uk-padding-remove-top"},[a("div",{staticClass:"form-container uk-overflow-auto"},[a("table",{staticClass:"uk-table uk-table-hover uk-table-middle uk-table-divider",staticStyle:{"background-color":"white"}},[t._m(0),t._v(" "),t._l(t.results,(function(e,s){return a("tbody",{attrs:{id:e.id}},[a("tr",[a("td",[t._v(t._s(s+1))]),t._v(" "),a("td",[t._v(t._s(e.name||"-"))]),t._v(" "),a("td",{staticClass:"uk-text-nowrap"},[t._v(t._s(e.phone||"-"))]),t._v(" "),a("td",[t._v(t._s(e.prefix||"-"))]),t._v(" "),a("td",{staticClass:"uk-text-nowrap"},[t._v(t._s(t.roles[e.role-1]))]),t._v(" "),a("td",[a("ul",{staticClass:"uk-iconnav"},[a("li",[a("a",{attrs:{"uk-icon":"icon: file-edit","uk-tooltip":"Редактировать"},on:{click:function(a){return a.preventDefault(),t.show([e.name,e.phone,e.prefix,e.role,e.id])}}})]),t._v(" "),a("li",[a("a",{attrs:{"uk-icon":"icon: trash","uk-tooltip":"title: Удалить; pos: bottom"},on:{click:function(a){return a.preventDefault(),t.deleteUser([e.id,s])}}})])])])])])}))],2)])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"uk-table-shrink"},[t._v("#")]),t._v(" "),a("th",{},[t._v("ФИО")]),t._v(" "),a("th",{},[t._v("Телефон")]),t._v(" "),a("th",{},[t._v("Префикс")]),t._v(" "),a("th",{},[t._v("Роль")]),t._v(" "),a("th",{},[t._v("Действия")])])])}],!1,null,"54281399",null).exports}}]);